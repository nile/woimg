<!DOCTYPE html>

<html>
    <head>
        <title>#{get 'title' /}</title>
        <meta charset="${_response_encoding}">
        <link rel="stylesheet" media="screen" href="@{'/public/css/reset.css'}">
        <link rel="stylesheet" media="screen" href="@{'/public/css/text.css'}">
        <link rel="stylesheet" media="screen" href="@{'/public/blueprint/src/forms.css'}">
        <link rel="stylesheet" media="screen" href="@{'/public/stylesheets/main.css'}">
        #{get 'moreStyles' /}
        <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
        <script src="@{'/public/javascripts/right.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/right/lightbox-src.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/woimg.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        #{get 'moreScripts' /}
    </head>
    <body>
    <div id="loading-hiddent-div" style="height:0px;">
	    <img src="/public/images/place-holder.png" id="img-holder">
    </div>
    <div class="container_12">
    	<div style="">
		    <h1 class="grid_8" style="margin-bottom:0px;">#{a @Application.index()}WOIMG#{/a}</h1>
		    <div class="grid_4 right" style="line-height:38px;">
			    <div>
			    <a class="menu-button" href="javascript:void(0);" onclick="javascript:tool_add();">+ADD</a>		    
			    #{if current_user != null}
			    	<a class="menu-button" href="@{Application.home(current_user.login)}">${current_user.login}</a>
			    	<a class="menu-button" href="@{CUser.logout()}">退出</a>
			    #{/if}
			    #{else}
			    	<a class="menu-button" href="@{CUser.joinin()}">JOIN IN</a>
			    #{/else}
			    </div>
		    </div>
		    <hr class="grid_12"/>
		    <div class="clear"></div>
	  	</div>
	    <div class="clear"></div>
	    #{doLayout /}
    </div>
    <script>
    function tool_add(){
        new Lightbox({showButtons:false, showTitle: false}).show($('dlg-tool-add').clone());
    }
    function add_from_website(){
        new Lightbox({showButtons:false, showTitle: false}).show($('dlg-add-from-website').clone());
    }
    function add_from_upload(){
        new Lightbox({showButtons:false, showTitle: false}).show($('dlg-add-from-upload').clone());
    }
    function create_board(){
        new Lightbox({showButtons:false, showTitle: false}).show($('dlg-add-create-board').clone());
    }
    function repaste(hash){
    	new Lightbox({showButtons:false, showTitle: false}).load('@{Application.prerepaste()}',{params:{'hash':hash}});
    }
    </script>
    
    <!-- 隐藏的对话框的代码 -->
	<div id="dlg-hidden-div" style="visibility:hidden;">
		<div id="dlg-tool-add" class="frame-border">
			<p><a href="javascript:void(0)" onclick="javascript:add_from_website()">从网站收藏</a></p>
			<p>
			<a href="javascript:void(0)" onclick="javascript:add_from_upload()">从文件上传</a>
			</p>
			<p>
			<a href="javascript:void(0)" onclick="javascript:create_board()">新建面板</a>
			</p>
			<div class="clear"></div>
		</div>
		<div id="dlg-add-from-upload" class="frame-border"  style="margin:5px;">
			上传本地图片
			#{form @Application.paste(), id:'file-load-form', enctype:'multipart/form-data'}
				<fieldset>
				<input class="title" type="hidden" name="type" value="file">
				<p><label>请选择一个图片</label><br/>
					<input class="title" type="file" name="file" style="width:226px;">
				</p>
				<p><label>请选择一个面板</label><br/>
				<select class="title" name="board" id="board" >
					#{list boards, as:'b'}
					<option value="${b.hash}">${b.name}</option>
					#{/list}
				</select>
				</p>
				<p><label>描述</label><br/>
				<textarea class="title" name="desc"></textarea>
				</p>
				<input class="title" type="submit" value="提交" >
				</fieldset>
			#{/form}
			<div class="clear"></div>
		</div>
		<div id="dlg-add-from-website" class="frame-border"  style="margin:5px;">
			#{form @Application.paste(), id:'url-load-form'}
				<fieldset>
				<legend>收藏网络图片</legend>
				<input class="title" type="hidden" name="type" value="url">
				<p><label>请选择一个图片</label><br/>
				<input class="title" type="text" name="url" style="width:220px;">
				</p>
				<p><label>请选择一个面板</label><br/>
				<select class="title" name="board" id="board" >
					#{list boards, as:'b'}
					<option value="${b.hash}">${b.name}</option>
					#{/list}
				</select>
				</p>
				<p><label>描述</label><br/>
				<textarea class="title" name="desc"></textarea>
				</p>
				<input class="title" type="submit" value="提交">
				</fieldset>
			#{/form}
			<div class="clear"></div>
		</div>
		<div id="dlg-add-create-board" class="frame-border"  style="margin:5px;">
			#{form @CBoard.create(), id:'url-load-form'}
				<fieldset>
				<legend>新建面板</legend>
				<p><label>名称</label><br/>
				<input class="title" type="text" name="name"></p>
				<p><label>分类</label><br/>
				<select class="title" name="category" id="board-category" >
					#{list categories, as:'cat'}
					<option value="${cat.code}">${cat.name}</option>
					#{/list}
				</select>
				</p>
				<input class="title" type="submit" value="提交">
				</fieldset>
			#{/form}
			<div class="clear"></div>
		</div>
	</div>    
    </body>
</html>
